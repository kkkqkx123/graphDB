åŸºäºå¯¹ `src/query/planner/plan` ç›®å½•çš„æ·±å…¥åˆ†æï¼Œæˆ‘å‘ç°äº†ä»¥ä¸‹ä¸»è¦é—®é¢˜ï¼š

## å½“å‰ç»“æ„å­˜åœ¨çš„é—®é¢˜

### 1. **åŠŸèƒ½é‡å¤**
- `logic_nodes.rs` å’Œ `other_ops.rs` ä¸­éƒ½å®šä¹‰äº† `Start` èŠ‚ç‚¹
- `logic_nodes.rs` å’Œ `other_ops.rs` ä¸­éƒ½å®šä¹‰äº† `Argument` èŠ‚ç‚¹
- `query_nodes.rs` åªæ˜¯é‡æ–°å¯¼å‡ºå…¶ä»–æ¨¡å—çš„èŠ‚ç‚¹ï¼Œæ²¡æœ‰å®é™…åŠŸèƒ½

### 2. **å¯¼å‡ºç»“æ„æ··ä¹±**
- `mod.rs` ä¸­åŒæ—¶ä½¿ç”¨ `pub use module::*` å’Œ `pub use module::{å…·ä½“ç±»å‹}`
- å­˜åœ¨é‡å¤å¯¼å‡ºï¼Œå¦‚ `Start` èŠ‚ç‚¹è¢«å¯¼å‡ºå¤šæ¬¡
- å¯¼å‡ºå±‚æ¬¡ä¸æ¸…æ™°ï¼Œéš¾ä»¥ç†è§£æ¨¡å—é—´çš„ä¾èµ–å…³ç³»

### 3. **æ¨¡å—åˆ’åˆ†ä¸åˆç†**
- æŒ‰æ“ä½œç±»å‹åˆ’åˆ†çš„æ¨¡å—ï¼ˆå¦‚ `traverse_ops.rs`ã€`data_ops.rs`ï¼‰ä¸æŒ‰åŠŸèƒ½åˆ’åˆ†çš„æ¨¡å—ï¼ˆå¦‚ `logic_nodes.rs`ï¼‰æ··åˆ
- æŸäº›æ¨¡å—åŒ…å«è¿‡å¤šä¸ç›¸å…³çš„èŠ‚ç‚¹ç±»å‹
- ç¼ºä¹ç»Ÿä¸€çš„åˆ†ç±»æ ‡å‡†


---

## ç›®å½•ç»“æ„è°ƒæ•´æ–¹æ¡ˆ

### æ–°çš„æ¨¡å—ç»„ç»‡ç»“æ„

æˆ‘å»ºè®®å°†ç›®å½•ç»“æ„é‡æ–°ç»„ç»‡ä¸ºä»¥ä¸‹å±‚æ¬¡ï¼š

```
src/query/planner/plan/
â”œâ”€â”€ core/                    # æ ¸å¿ƒåŸºç¡€ç±»å‹
â”‚   â”œâ”€â”€ mod.rs              # å¯¼å‡ºåŸºç¡€ç‰¹å¾å’Œæšä¸¾
â”‚   â”œâ”€â”€ plan_node.rs        # PlanNode ç‰¹å¾å’ŒåŸºç¡€å®ç°
â”‚   â”œâ”€â”€ plan_node_kind.rs   # PlanNodeKind æšä¸¾
â”‚   â””â”€â”€ visitor.rs          # è®¿é—®è€…æ¨¡å¼ç›¸å…³
â”œâ”€â”€ operations/             # æ“ä½œèŠ‚ç‚¹ï¼ˆæŒ‰åŠŸèƒ½åˆ†ç±»ï¼‰
â”‚   â”œâ”€â”€ graph_scan/         # å›¾æ‰«ææ“ä½œ
â”‚   â”œâ”€â”€ traversal/          # å›¾éå†æ“ä½œ
â”‚   â”œâ”€â”€ data_processing/    # æ•°æ®å¤„ç†æ“ä½œ
â”‚   â”œâ”€â”€ join/              # è¿æ¥æ“ä½œ
â”‚   â”œâ”€â”€ aggregation/       # èšåˆæ“ä½œ
â”‚   â”œâ”€â”€ sorting/           # æ’åºå’Œé™åˆ¶æ“ä½œ
â”‚   â””â”€â”€ control_flow/       # æ§åˆ¶æµæ“ä½œ
â”œâ”€â”€ management/             # ç®¡ç†æ“ä½œèŠ‚ç‚¹
â”‚   â”œâ”€â”€ schema/            # æ¨¡å¼ç®¡ç†
â”‚   â”œâ”€â”€ data/              # æ•°æ®ç®¡ç†
â”‚   â””â”€â”€ system/             # ç³»ç»Ÿç®¡ç†
â”œâ”€â”€ algorithms/             # ç®—æ³•èŠ‚ç‚¹
â”‚   â”œâ”€â”€ path_finding/      # è·¯å¾„æŸ¥æ‰¾ç®—æ³•
â”‚   â””â”€â”€ search/            # æœç´¢ç®—æ³•
â””â”€â”€ mod.rs                  # ç»Ÿä¸€å¯¼å‡ºæ¥å£
```

### å…·ä½“è°ƒæ•´å†…å®¹

**1. è§£å†³åŠŸèƒ½é‡å¤é—®é¢˜**
- ç§»é™¤é‡å¤çš„ `Start` å’Œ `Argument` èŠ‚ç‚¹å®šä¹‰
- ç»Ÿä¸€åˆ°å•ä¸€æ¨¡å—ä¸­å®šä¹‰
- åˆ é™¤ `query_nodes.rs`ï¼ˆä»…é‡æ–°å¯¼å‡ºçš„æ¨¡å—ï¼‰

**2. ä¼˜åŒ–å¯¼å‡ºç»“æ„**
- é‡‡ç”¨ç»Ÿä¸€çš„å¯¼å‡ºç­–ç•¥ï¼šåªå¯¼å‡ºå…·ä½“ç±»å‹ï¼Œä¸å¯¼å‡º `*`
- å»ºç«‹æ¸…æ™°çš„å¯¼å‡ºå±‚æ¬¡ç»“æ„
- é¿å…å¾ªç¯ä¾èµ–å’Œé‡å¤å¯¼å‡º

**3. é‡æ–°åˆ’åˆ†æ¨¡å—è¾¹ç•Œ**
- æŒ‰åŠŸèƒ½è€Œéæ“ä½œç±»å‹åˆ’åˆ†æ¨¡å—
- æ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€ï¼ŒåŠŸèƒ½å†…èš
- å»ºç«‹æ¸…æ™°çš„ä¾èµ–å…³ç³»

---

## æ–°çš„æ¨¡å—ç»„ç»‡æ¶æ„è®¾è®¡

### æ¨¡å—è¯¦ç»†åˆ’åˆ†æ–¹æ¡ˆ

```mermaid
graph TB
    subgraph "æ ¸å¿ƒå±‚ Core"
        A1[plan_node.rs<br/>PlanNodeç‰¹å¾]
        A2[plan_node_kind.rs<br/>èŠ‚ç‚¹ç±»å‹æšä¸¾]
        A3[visitor.rs<br/>è®¿é—®è€…æ¨¡å¼]
        A4[common.rs<br/>é€šç”¨ç±»å‹]
    end
    
    subgraph "æ“ä½œå±‚ Operations"
        B1[graph_scan/<br/>å›¾æ‰«ææ“ä½œ]
        B2[traversal/<br/>å›¾éå†æ“ä½œ]
        B3[data_processing/<br/>æ•°æ®å¤„ç†]
        B4[join/<br/>è¿æ¥æ“ä½œ]
        B5[aggregation/<br/>èšåˆæ“ä½œ]
        B6[sorting/<br/>æ’åºé™åˆ¶]
        B7[control_flow/<br/>æ§åˆ¶æµ]
    end
    
    subgraph "ç®¡ç†å±‚ Management"
        C1[schema/<br/>æ¨¡å¼ç®¡ç†]
        C2[data/<br/>æ•°æ®ç®¡ç†]
        C3[system/<br/>ç³»ç»Ÿç®¡ç†]
    end
    
    subgraph "ç®—æ³•å±‚ Algorithms"
        D1[path_finding/<br/>è·¯å¾„æŸ¥æ‰¾]
        D2[search/<br/>æœç´¢ç®—æ³•]
    end
    
    A1 --> B1
    A1 --> B2
    A1 --> B3
    A1 --> B4
    A1 --> B5
    A1 --> B6
    A1 --> B7
    A1 --> C1
    A1 --> C2
    A1 --> C3
    A1 --> D1
    A1 --> D2
```

### æ¨¡å—èŒè´£åˆ’åˆ†

**1. æ ¸å¿ƒå±‚ (core/)**
- `plan_node.rs`: PlanNode ç‰¹å¾å’ŒåŸºç¡€å®ç°
- `plan_node_kind.rs`: PlanNodeKind æšä¸¾å®šä¹‰
- `visitor.rs`: è®¿é—®è€…æ¨¡å¼ç›¸å…³
- `common.rs`: é€šç”¨ç±»å‹ï¼ˆTagProp, EdgeProp ç­‰ï¼‰

**2. æ“ä½œå±‚ (operations/)**
- `graph_scan/`: GetVertices, GetEdges, GetNeighbors, ScanVertices, ScanEdges
- `traversal/`: Traverse, Expand, ExpandAll, AppendVertices
- `data_processing/`: Filter, Project, Unwind, Dedup, Union
- `join/`: HashJoin, CrossJoin, HashLeftJoin, HashInnerJoin
- `aggregation/`: Aggregate
- `sorting/`: Sort, Limit, TopN, Sample
- `control_flow/`: Start, Argument, Select, Loop, PassThrough

**3. ç®¡ç†å±‚ (management/)**
- `schema/`: CreateSpace, CreateTag, CreateEdge, DropNode ç­‰
- `data/`: InsertVertices, InsertEdges, UpdateVertex, DeleteVertices ç­‰
- `system/`: SubmitJob, CreateSnapshot, ShowConfigs ç­‰

**4. ç®—æ³•å±‚ (algorithms/)**
- `path_finding/`: ShortestPath, MultiShortestPath, AllPaths, BFSShortest
- `search/`: IndexScan, FulltextIndexScan

---

## é‡æ„å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šåˆ›å»ºæ–°ç›®å½•ç»“æ„
1. åˆ›å»ºæ–°çš„ç›®å½•å±‚æ¬¡ç»“æ„
2. è¿ç§»æ ¸å¿ƒåŸºç¡€ç±»å‹åˆ° `core/` ç›®å½•
3. å»ºç«‹æ–°çš„æ¨¡å—å¯¼å‡ºæœºåˆ¶

### é˜¶æ®µäºŒï¼šè¿ç§»æ“ä½œèŠ‚ç‚¹
1. æŒ‰åŠŸèƒ½é‡æ–°ç»„ç»‡æ“ä½œèŠ‚ç‚¹åˆ°å¯¹åº”æ¨¡å—
2. è§£å†³é‡å¤å®šä¹‰é—®é¢˜
3. æ›´æ–°èŠ‚ç‚¹é—´çš„ä¾èµ–å…³ç³»

### é˜¶æ®µä¸‰ï¼šæ›´æ–°å¯¼å‡ºæœºåˆ¶
1. é‡æ–°è®¾è®¡ `mod.rs` çš„å¯¼å‡ºç»“æ„
2. ç¡®ä¿å‘åå…¼å®¹æ€§
3. æ›´æ–°æ‰€æœ‰å¼•ç”¨è¿™äº›æ¨¡å—çš„ä»£ç 

### é˜¶æ®µå››ï¼šæµ‹è¯•å’ŒéªŒè¯
1. è¿è¡Œç°æœ‰æµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸
2. éªŒè¯æ–°çš„å¯¼å‡ºç»“æ„
3. ä¿®å¤å‘ç°çš„ä»»ä½•é—®é¢˜

## å…·ä½“é‡æ„æ­¥éª¤

**ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ–°ç›®å½•ç»“æ„**
```bash
mkdir -p src/query/planner/plan/core
mkdir -p src/query/planner/plan/operations/{graph_scan,traversal,data_processing,join,aggregation,sorting,control_flow}
mkdir -p src/query/planner/plan/management/{schema,data,system}
mkdir -p src/query/planner/plan/algorithms/{path_finding,search}
```

**ç¬¬äºŒæ­¥ï¼šè¿ç§»æ ¸å¿ƒæ–‡ä»¶**
- å°† `plan_node.rs` ç§»åŠ¨åˆ° `core/plan_node.rs`
- å°† `plan_node_kind.rs` ä» `plan_node.rs` åˆ†ç¦»åˆ° `core/plan_node_kind.rs`
- å°† `plan_node_visitor.rs` ç§»åŠ¨åˆ° `core/visitor.rs`
- å°† `common.rs` ç§»åŠ¨åˆ° `core/common.rs`

**ç¬¬ä¸‰æ­¥ï¼šé‡æ–°ç»„ç»‡æ“ä½œèŠ‚ç‚¹**
- å°†ç›¸å…³èŠ‚ç‚¹ç§»åŠ¨åˆ°å¯¹åº”çš„åŠŸèƒ½æ¨¡å—
- åˆ é™¤é‡å¤çš„å®šä¹‰
- æ›´æ–°æ¨¡å—é—´çš„å¯¼å…¥å…³ç³»

**ç¬¬å››æ­¥ï¼šé‡æ–°è®¾è®¡å¯¼å‡ºç»“æ„**
- åˆ›å»ºæ¸…æ™°çš„å¯¼å‡ºå±‚æ¬¡
- é¿å…é‡å¤å¯¼å‡º
- ä¿æŒAPIå…¼å®¹æ€§

---

## src/query/planner/plan ç›®å½•ç»“æ„è°ƒæ•´æ–¹æ¡ˆ

åŸºäºæ·±å…¥åˆ†æï¼Œæˆ‘å‘ç°äº†å½“å‰ç›®å½•ç»“æ„å­˜åœ¨çš„ä¸»è¦é—®é¢˜å¹¶åˆ¶å®šäº†å®Œæ•´çš„è°ƒæ•´æ–¹æ¡ˆã€‚

### ğŸ“‹ é—®é¢˜æ€»ç»“

**1. åŠŸèƒ½é‡å¤**
- `logic_nodes.rs` å’Œ `other_ops.rs` ä¸­éƒ½å®šä¹‰äº† `Start` å’Œ `Argument` èŠ‚ç‚¹
- `query_nodes.rs` åªæ˜¯é‡æ–°å¯¼å‡ºï¼Œæ²¡æœ‰å®é™…åŠŸèƒ½

**2. å¯¼å‡ºç»“æ„æ··ä¹±**
- åŒæ—¶ä½¿ç”¨ `pub use module::*` å’Œå…·ä½“ç±»å‹å¯¼å‡º
- å­˜åœ¨é‡å¤å¯¼å‡ºå’Œå¾ªç¯ä¾èµ–
- å¯¼å‡ºå±‚æ¬¡ä¸æ¸…æ™°

**3. æ¨¡å—åˆ’åˆ†ä¸åˆç†**
- æŒ‰æ“ä½œç±»å‹å’ŒåŠŸèƒ½åˆ’åˆ†çš„æ¨¡å—æ··åˆå­˜åœ¨
- æŸäº›æ¨¡å—åŒ…å«è¿‡å¤šä¸ç›¸å…³çš„èŠ‚ç‚¹ç±»å‹
- ç¼ºä¹ç»Ÿä¸€çš„åˆ†ç±»æ ‡å‡†

### ğŸ—ï¸ æ–°çš„æ¶æ„è®¾è®¡

```mermaid
graph TB
    subgraph "æ ¸å¿ƒå±‚ Core"
        A1[plan_node.rs<br/>PlanNodeç‰¹å¾]
        A2[plan_node_kind.rs<br/>èŠ‚ç‚¹ç±»å‹æšä¸¾]
        A3[visitor.rs<br/>è®¿é—®è€…æ¨¡å¼]
        A4[common.rs<br/>é€šç”¨ç±»å‹]
    end
    
    subgraph "æ“ä½œå±‚ Operations"
        B1[graph_scan/<br/>å›¾æ‰«ææ“ä½œ]
        B2[traversal/<br/>å›¾éå†æ“ä½œ]
        B3[data_processing/<br/>æ•°æ®å¤„ç†]
        B4[join/<br/>è¿æ¥æ“ä½œ]
        B5[aggregation/<br/>èšåˆæ“ä½œ]
        B6[sorting/<br/>æ’åºé™åˆ¶]
        B7[control_flow/<br/>æ§åˆ¶æµ]
    end
    
    subgraph "ç®¡ç†å±‚ Management"
        C1[schema/<br/>æ¨¡å¼ç®¡ç†]
        C2[data/<br/>æ•°æ®ç®¡ç†]
        C3[system/<br/>ç³»ç»Ÿç®¡ç†]
    end
    
    subgraph "ç®—æ³•å±‚ Algorithms"
        D1[path_finding/<br/>è·¯å¾„æŸ¥æ‰¾]
        D2[search/<br/>æœç´¢ç®—æ³•]
    end
    
    A1 --> B1
    A1 --> B2
    A1 --> B3
    A1 --> B4
    A1 --> B5
    A1 --> B6
    A1 --> B7
    A1 --> C1
    A1 --> C2
    A1 --> C3
    A1 --> D1
    A1 --> D2
```

### ğŸ”„ é‡æ„è®¡åˆ’

**é˜¶æ®µä¸€ï¼šåˆ›å»ºæ–°ç›®å½•ç»“æ„**
- å»ºç«‹æ¸…æ™°çš„æ¨¡å—å±‚æ¬¡
- è¿ç§»æ ¸å¿ƒåŸºç¡€ç±»å‹

**é˜¶æ®µäºŒï¼šé‡æ–°ç»„ç»‡æ“ä½œèŠ‚ç‚¹**
- æŒ‰åŠŸèƒ½é‡æ–°åˆ†é…èŠ‚ç‚¹åˆ°å¯¹åº”æ¨¡å—
- è§£å†³é‡å¤å®šä¹‰é—®é¢˜

**é˜¶æ®µä¸‰ï¼šä¼˜åŒ–å¯¼å‡ºæœºåˆ¶**
- è®¾è®¡æ¸…æ™°çš„å¯¼å‡ºå±‚æ¬¡
- ç¡®ä¿å‘åå…¼å®¹æ€§

**é˜¶æ®µå››ï¼šæµ‹è¯•éªŒè¯**
- è¿è¡Œç°æœ‰æµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸
- éªŒè¯æ–°çš„ç»“æ„

### ğŸ’¡ é¢„æœŸæ”¶ç›Š

1. **æ¶ˆé™¤é‡å¤ä»£ç ** - è§£å†³åŠŸèƒ½é‡å¤é—®é¢˜
2. **æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ** - æ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€
3. **æ›´å¥½çš„å¯ç»´æŠ¤æ€§** - ç»“æ„æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•
4. **ç»Ÿä¸€çš„å¯¼å‡ºç­–ç•¥** - é¿å…å¯¼å‡ºæ··ä¹±

æ‚¨å¯¹è¿™ä¸ªè°ƒæ•´æ–¹æ¡ˆæœ‰ä»€ä¹ˆçœ‹æ³•ï¼Ÿæ˜¯å¦éœ€è¦è°ƒæ•´æŸäº›æ¨¡å—çš„åˆ’åˆ†æ–¹å¼ï¼Ÿ