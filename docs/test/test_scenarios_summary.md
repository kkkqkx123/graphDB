# GraphDB 测试场景汇总

## 1. 测试场景总览

### 1.1 场景分类

| 场景类别 | 场景名称 | 优先级 | 状态 |
|----------|----------|--------|------|
| 业务场景 | 社交网络 | P0 | 待实现 |
| 业务场景 | 电商推荐 | P1 | 待实现 |
| 业务场景 | 知识图谱 | P2 | 待实现 |
| 工作流 | 模式演进 | P0 | 待实现 |
| 工作流 | 数据迁移 | P1 | 待实现 |
| 工作流 | 备份恢复 | P1 | 待实现 |
| 性能 | 并发写入 | P0 | 待实现 |
| 性能 | 并发查询 | P1 | 待实现 |
| 性能 | 大图处理 | P2 | 待实现 |
| 回归 | Bug 修复验证 | P1 | 待实现 |

---

## 2. 详细测试用例清单

### 2.1 社交网络场景 (Social Network)

#### 数据模型

```
顶点类型：
┌─────────────┬────────────────────────────────────────────┐
│ 类型        │ 属性                                        │
├─────────────┼────────────────────────────────────────────┤
│ Person      │ id, name, age, city, created_at            │
│ Post        │ id, content, created_at, likes             │
│ Comment     │ id, content, created_at                    │
│ Group       │ id, name, description, created_at          │
└─────────────┴────────────────────────────────────────────┘

边类型：
┌─────────────┬────────────────────────────────────────────┐
│ 类型        │ 属性                                        │
├─────────────┼────────────────────────────────────────────┤
│ KNOWS       │ since, strength                            │
│ FOLLOWS     │ since                                      │
│ POSTED      │ -                                          │
│ LIKES       │ created_at                                 │
│ COMMENTED   │ -                                          │
│ ON          │ -                                          │
│ MEMBER_OF   │ joined_at, role                            │
└─────────────┴────────────────────────────────────────────┘
```

#### 测试用例列表

| 用例 ID | 用例名称 | 描述 | 前置条件 | 预期结果 |
|---------|----------|------|----------|----------|
| TC-SN-01 | 用户注册与好友添加 | 创建用户并建立好友关系 | 空数据库 | 好友关系正确建立，可查询 |
| TC-SN-02 | 多层好友关系查询 | 查询多层好友网络 | 已建立 3 层好友网络 | 返回正确的好友层级 |
| TC-SN-03 | 动态发布与互动 | 发布帖子并点赞评论 | 已创建用户 | 互动记录正确存储 |
| TC-SN-04 | 群组管理与成员查询 | 创建群组并管理成员 | 已创建群组标签 | 成员角色正确管理 |
| TC-SN-05 | 共同好友发现 | 查找两个用户的共同好友 | 已建立好友网络 | 返回共同好友列表 |
| TC-SN-06 | 好友推荐 | 基于共同好友推荐 | 已建立好友网络 | 返回推荐好友列表 |
| TC-SN-07 | 动态时间线 | 查询用户动态时间线 | 已发布多条动态 | 按时间排序返回动态 |
| TC-SN-08 | 影响力分析 | 计算用户影响力分数 | 已建立完整社交网络 | 返回影响力排名 |
| TC-SN-09 | 社区发现 | 识别社交网络中的社区 | 已建立复杂网络 | 正确识别社区结构 |
| TC-SN-10 | 信息传播路径 | 追踪信息传播路径 | 已建立转发关系 | 返回传播路径 |

---

### 2.2 电商推荐场景 (E-Commerce)

#### 数据模型

```
顶点类型：
┌─────────────┬────────────────────────────────────────────┐
│ 类型        │ 属性                                        │
├─────────────┼────────────────────────────────────────────┤
│ User        │ id, name, age, gender, city                │
│ Product     │ id, name, category, price, brand           │
│ Category    │ id, name, parent_id                        │
│ Order       │ id, total_amount, status, created_at       │
└─────────────┴────────────────────────────────────────────┘

边类型：
┌─────────────┬────────────────────────────────────────────┐
│ 类型        │ 属性                                        │
├─────────────┼────────────────────────────────────────────┤
│ VIEWED      │ view_time, duration                        │
│ ADDED_TO_CART│ added_at, quantity                        │
│ PURCHASED   │ order_id, quantity, price                  │
│ BELONGS_TO  │ -                                          │
│ SIMILAR_TO  │ similarity_score                           │
│ BOUGHT_TOGETHER│ frequency                              │
└─────────────┴────────────────────────────────────────────┘
```

#### 测试用例列表

| 用例 ID | 用例名称 | 描述 | 前置条件 | 预期结果 |
|---------|----------|------|----------|----------|
| TC-EC-01 | 商品目录管理 | 创建分类和商品 | 空数据库 | 商品正确分类 |
| TC-EC-02 | 用户行为追踪 | 记录用户浏览购买行为 | 已创建商品 | 行为序列完整记录 |
| TC-EC-03 | 相似商品推荐 | 基于相似度推荐商品 | 已建立相似度关系 | 返回相似商品列表 |
| TC-EC-04 | 协同过滤推荐 | 基于用户行为推荐 | 已存在购买记录 | 返回个性化推荐 |
| TC-EC-05 | 购物车放弃分析 | 分析购物车放弃行为 | 存在加购记录 | 识别放弃行为 |
| TC-EC-06 | 热销商品排行 | 统计热销商品 | 已存在订单数据 | 返回热销榜单 |
| TC-EC-07 | 用户分群 | 基于行为对用户分群 | 已存在用户行为 | 正确识别用户群体 |
| TC-EC-08 | 购买路径分析 | 分析用户购买路径 | 已存在行为数据 | 返回常见路径 |
| TC-EC-09 | 库存预警 | 监控库存并预警 | 已创建商品库存 | 正确触发预警 |
| TC-EC-10 | 价格弹性分析 | 分析价格对销量的影响 | 已存在历史数据 | 返回弹性系数 |

---

### 2.3 知识图谱场景 (Knowledge Graph)

#### 数据模型

```
顶点类型：
┌─────────────┬────────────────────────────────────────────┐
│ 类型        │ 属性                                        │
├─────────────┼────────────────────────────────────────────┤
│ Entity      │ id, name, type, description                │
│ Concept     │ id, name, domain                           │
│ Document    │ id, title, content, source                 │
└─────────────┴────────────────────────────────────────────┘

边类型：
┌─────────────┬────────────────────────────────────────────┐
│ 类型        │ 属性                                        │
├─────────────┼────────────────────────────────────────────┤
│ RELATES_TO  │ relation_type, confidence                  │
│ INSTANCE_OF │ -                                          │
│ MENTIONS    │ frequency                                  │
│ PART_OF     │ -                                          │
│ CAUSES      │ -                                          │
└─────────────┴────────────────────────────────────────────┘
```

#### 测试用例列表

| 用例 ID | 用例名称 | 描述 | 前置条件 | 预期结果 |
|---------|----------|------|----------|----------|
| TC-KG-01 | 实体关系查询 | 查询实体间关系 | 已构建知识图谱 | 返回关系列表 |
| TC-KG-02 | 多跳关系推理 | 推理多跳关系 | 已建立关系链 | 返回推理路径 |
| TC-KG-03 | 知识一致性验证 | 验证知识一致性 | 存在循环关系 | 识别不一致性 |
| TC-KG-04 | 实体链接 | 链接不同来源实体 | 存在多源数据 | 正确链接实体 |
| TC-KG-05 | 知识补全 | 补全缺失知识 | 存在不完整知识 | 补全缺失关系 |
| TC-KG-06 | 知识推理 | 基于规则推理新知识 | 已定义推理规则 | 生成新关系 |
| TC-KG-07 | 实体消歧 | 消除实体歧义 | 存在同名实体 | 正确区分实体 |
| TC-KG-08 | 知识图谱可视化 | 生成可视化数据 | 已构建知识图谱 | 返回图数据 |
| TC-KG-09 | 问答系统 | 基于图谱回答问题 | 已构建知识图谱 | 返回答案 |
| TC-KG-10 | 知识更新 | 增量更新知识 | 已存在知识图谱 | 正确合并更新 |

---

### 2.4 模式演进工作流 (Schema Evolution)

#### 测试用例列表

| 用例 ID | 用例名称 | 描述 | 前置条件 | 预期结果 |
|---------|----------|------|----------|----------|
| TC-SE-01 | 标签属性添加 | 向标签添加新属性 | 已存在标签 | 属性成功添加 |
| TC-SE-02 | 标签属性修改 | 修改属性类型 | 已存在属性 | 类型成功修改 |
| TC-SE-03 | 标签属性删除 | 删除标签属性 | 标签存在多个属性 | 属性成功删除 |
| TC-SE-04 | 标签重命名 | 重命名标签 | 已存在标签 | 标签成功重命名 |
| TC-SE-05 | 边类型修改 | 修改边类型定义 | 已存在边类型 | 修改成功 |
| TC-SE-06 | 索引重建 | 重建索引 | 已存在索引 | 索引成功重建 |
| TC-SE-07 | 数据迁移 | 迁移数据到新模式 | 已定义新模式 | 数据成功迁移 |
| TC-SE-08 | 模式版本控制 | 管理模式版本 | 已存在多版本 | 版本正确管理 |
| TC-SE-09 | 回滚测试 | 回滚模式变更 | 已执行变更 | 成功回滚 |
| TC-SE-10 | 兼容性检查 | 检查模式兼容性 | 准备变更模式 | 正确识别不兼容 |

---

### 2.5 性能测试场景 (Performance)

#### 测试用例列表

| 用例 ID | 用例名称 | 描述 | 前置条件 | 预期结果 |
|---------|----------|------|----------|----------|
| TC-PF-01 | 并发写入测试 | 多并发写入数据 | 空数据库 | 数据完整性保证 |
| TC-PF-02 | 并发查询测试 | 多并发执行查询 | 已存在数据 | 查询性能达标 |
| TC-PF-03 | 批量数据导入 | 导入大量数据 | 空数据库 | 导入成功完成 |
| TC-PF-04 | 大图遍历性能 | 在大图上执行遍历 | 已存在大图 | 遍历性能达标 |
| TC-PF-05 | 复杂查询性能 | 执行复杂查询 | 已存在数据 | 查询响应及时 |
| TC-PF-06 | 索引查询性能 | 测试索引查询速度 | 已建立索引 | 查询使用索引 |
| TC-PF-07 | 内存使用测试 | 监控内存使用 | 执行大量操作 | 内存使用合理 |
| TC-PF-08 | 连接池测试 | 测试连接池性能 | 配置连接池 | 连接管理高效 |
| TC-PF-09 | 缓存性能测试 | 测试缓存命中率 | 启用缓存 | 命中率达标 |
| TC-PF-10 | 压力测试 | 系统极限压力测试 | 完整系统 | 系统稳定运行 |

---

## 3. 测试数据规模

### 3.1 数据规模定义

| 规模级别 | 顶点数量 | 边数量 | 适用场景 |
|----------|----------|--------|----------|
| 小型 | 10-100 | 50-500 | 单元测试、快速验证 |
| 中型 | 1,000-10,000 | 5,000-50,000 | 功能测试、集成测试 |
| 大型 | 100,000-1,000,000 | 500,000-5,000,000 | 性能测试、压力测试 |
| 超大型 | 10,000,000+ | 50,000,000+ | 极限测试、基准测试 |

### 3.2 各场景推荐数据规模

| 场景 | 开发测试 | CI 测试 | 性能测试 |
|------|----------|---------|----------|
| 社交网络 | 小型 | 中型 | 大型 |
| 电商推荐 | 小型 | 中型 | 大型 |
| 知识图谱 | 小型 | 中型 | 大型 |
| 模式演进 | 小型 | 小型 | 中型 |
| 并发测试 | 中型 | 大型 | 超大型 |

---

## 4. 测试执行矩阵

### 4.1 环境与场景矩阵

| 场景 | 本地开发 | CI 环境 | 预发布 | 生产验证 |
|------|----------|---------|--------|----------|
| TC-SN-01~05 | ✓ | ✓ | ✓ | - |
| TC-SN-06~10 | ✓ | ✓ | - | - |
| TC-EC-01~05 | ✓ | ✓ | ✓ | - |
| TC-EC-06~10 | ✓ | ✓ | - | - |
| TC-KG-01~05 | ✓ | ✓ | - | - |
| TC-KG-06~10 | ✓ | - | - | - |
| TC-SE-01~05 | ✓ | ✓ | ✓ | - |
| TC-SE-06~10 | ✓ | ✓ | - | - |
| TC-PF-01~05 | ✓ | ✓ | ✓ | ✓ |
| TC-PF-06~10 | - | - | ✓ | ✓ |

### 4.2 执行频率

| 测试类型 | 执行触发条件 | 预计执行时间 |
|----------|--------------|--------------|
| 快速冒烟测试 | 每次提交 | < 5 分钟 |
| 完整功能测试 | PR 合并前 | < 30 分钟 |
| 性能基准测试 | 每日构建 | < 2 小时 |
| 全量回归测试 | 版本发布前 | < 4 小时 |

---

## 5. 测试依赖关系

### 5.1 场景内依赖

```
社交网络场景：
TC-SN-01 (基础数据准备)
    ├── TC-SN-02 (依赖好友网络)
    ├── TC-SN-03 (依赖用户数据)
    ├── TC-SN-04 (依赖群组功能)
    └── TC-SN-05 (依赖好友网络)

电商推荐场景：
TC-EC-01 (基础数据准备)
    ├── TC-EC-02 (依赖商品数据)
    ├── TC-EC-03 (依赖相似度计算)
    └── TC-EC-04 (依赖用户行为)
```

### 5.2 场景间依赖

```
模式演进场景依赖于：
- 社交网络场景的基础数据
- 电商场景的分类体系

性能测试场景依赖于：
- 所有功能场景的数据模型
- 各场景的基础测试数据
```

---

## 6. 风险评估

### 6.1 测试风险

| 风险 | 可能性 | 影响 | 缓解措施 |
|------|--------|------|----------|
| 测试数据准备耗时 | 高 | 中 | 数据生成工具化、缓存数据 |
| 测试执行时间过长 | 中 | 高 | 并行执行、选择性执行 |
| 测试环境不稳定 | 中 | 中 | 环境隔离、重试机制 |
| 测试覆盖不足 | 低 | 高 | 基于风险设计、定期评审 |
| 测试维护成本高 | 中 | 中 | 代码复用、文档完善 |

### 6.2 优先级调整建议

**当前优先级（P0/P1/P2）**

建议根据以下因素动态调整：

1. **业务重要性**：核心功能提升为 P0
2. **缺陷历史**：易出问题的场景提升优先级
3. **用户反馈**：用户关注的功能优先测试
4. **技术债务**：技术复杂度高的优先验证

---

## 7. 测试度量指标

### 7.1 覆盖率指标

| 指标 | 目标值 | 测量方法 |
|------|--------|----------|
| 代码覆盖率 | > 80% | cargo tarpaulin |
| 功能覆盖率 | > 90% | 测试用例评审 |
| 场景覆盖率 | 100% | 场景清单核对 |
| 边界条件覆盖率 | > 70% | 边界分析 |

### 7.2 质量指标

| 指标 | 目标值 | 测量周期 |
|------|--------|----------|
| 测试通过率 | > 98% | 每次执行 |
| 缺陷逃逸率 | < 2% | 每个版本 |
| 平均修复时间 | < 1 天 | 实时 |
| 测试稳定性 | > 95% | 每周 |

### 7.3 效率指标

| 指标 | 目标值 | 优化方向 |
|------|--------|----------|
| 测试执行时间 | < 30 分钟 | 并行化、选择性执行 |
| 数据准备时间 | < 5 分钟 | 数据复用、延迟加载 |
| 调试定位时间 | < 30 分钟 | 日志完善、诊断工具 |
| 用例开发效率 | 2 个/人天 | 框架优化、代码复用 |
